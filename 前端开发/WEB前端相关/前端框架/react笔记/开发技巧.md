# props 变化导致多次请求
我们在封装组件的时候，有时会把请求放在组件中，当 props 的某些值变化时，组件内部监听到变化会重新发送请求。
但是有时 props 会有很多属性，可能多个属性变化时都需要重新发送请求，比如 uid, pid, type, role 等变化都需要重新获取数据。但是我们在父组件中可能先修改 uid 再修改 role，比如 uid 变化后传给另一个组件，另一个组件中修改 role。这时组件中发送的请求就可能发送两次，一次是 uid 变化导致，一次是 role 变化导致。但是其实这两次修改时间间隔会很近，因为都是内部 js 的运算，所以我们可以通过对请求数据的函数做防抖处理，在100ms内只发送一次请求，这样就能解决此问题。
但是还有种情况，父组件中 uid 变化后，需要请求接口获取 role，这时组件中监听 uid 和 role 请求接口，100ms 的防抖可能就不够用了。所以我们的组件可以接受一个 requestWait 属性，父组件修改 uid 后，需要请求接口获取 role，所以在修改 uid 时也要将一个新的 state 即 requestWait 改为 true。组件中监听到 uid 发生了变化，准备请求接口获取数据，但是请求时发现 requestWait 是 true 的，所以放弃请求。而父组件中 role 请求完成后，将 requestWait 改为 false，组件中监听到 role 发生变化再次请求接口，这时 requestWait 是 false 的，所以正常请求。当然，我们也可以将 requestWait 也放到依赖中，这样 role 接口请求出错，也会修改 requestWait 为 false，我们也会发送一次请求，这就需要根据需求而定了。